{"sql": "select\n\tyears.year,\n\tsum(ifnull(open_measure, 0)) as open_deposites_count,\n\tsum(ifnull(prolongated_measure, 0)) as prolongated_deposites_count,\n\tsum(ifnull(periods.opening_amt*2 > prev_periods.opening_amt*3, 0)) as up50_deposites_count\nfrom\n\t(\n\tselect\n\t\tdistinct year(calendar_dt) as year\n\tfrom\n\t\tsrcdt.calendar) as years\nleft join (\n\tselect\n\t\topening_amt,\n\t\taccount_rk,\n\t\taccount_renewal_cnt,\n\t\taccount_renewal_cnt = 1 as open_measure,\n\t\taccount_renewal_cnt >= 2 as prolongated_measure,\n\t\trenewed_dt,\n\t\texpiration_dt\n\tfrom\n\t\tsrcdt.account_periods) as periods on\n\tyears.year = year(periods.renewed_dt)\nleft join (\n\tselect\n\t\topening_amt,\n\t\taccount_rk,\n\t\taccount_renewal_cnt\n\tfrom\n\t\tsrcdt.account_periods) as prev_periods on\n\tprev_periods.account_rk = periods.account_rk\n\tand prev_periods.account_renewal_cnt = periods.account_renewal_cnt - 1\ngroup by\n\tyears.year", "valid_until": 2044393056.718052, "rows": 13, "hash": 6135695584710108749, "data": "(2007, Decimal('0'), Decimal('0'), Decimal('0'))"}