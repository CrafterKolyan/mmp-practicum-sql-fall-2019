{"sql": "SELECT a.renewed_year, cnt_opens, cnt_prolong, IFNULL(cnt_increased, 0) AS cnt_increased\nFROM(\n\tSELECT \n\t\tYEAR(renewed_dt) AS renewed_year, \n\t\tSUM(account_renewal_cnt = 1) AS cnt_opens, \n\t\tSUM(account_renewal_cnt >= 2) AS cnt_prolong\n\tFROM account_periods\n\tGROUP BY renewed_year\n) a\nLEFT JOIN (\n\tSELECT YEAR(a.renewed_dt) AS renewed_year, COUNT(*) AS cnt_increased\n\tFROM account_periods a\n\tINNER JOIN account_periods b\n\tON \n\t\t(a.account_rk = b.account_rk) \n\t\tAND (a.account_renewal_cnt = b.account_renewal_cnt + 1) \n\t\tAND (a.opening_amt > 1.5 * b.opening_amt)\n\tGROUP BY renewed_year\n) b\nON a.renewed_year = b.renewed_year\n", "valid_until": 253402300800.0, "rows": 10, "hash": 3193847143122701252, "data": "(2010, Decimal('90155'), Decimal('24601'), 10991)"}