{"sql": "select\n\tmonth,\n\tfrom_cnt,\n\tto_cnt,\n\tcount(*) as cnt\nfrom\n(\n\t(\n\tselect\n\t\tdate_format(curr.renewed_dt, '%Y-%d') as month,\n\t\tifnull(prev.account_renewal_cnt, 0) as from_cnt,\n\t\tcurr.account_renewal_cnt as to_cnt\n\tfrom\n\t\t(\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tsrcdt.account_periods) as prev\n\tright join (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tsrcdt.account_periods) as curr on\n\t\tcurr.account_rk = prev.account_rk\n\t\tand curr.account_renewal_cnt = prev.account_renewal_cnt + 1)\nunion all (\n\tselect\n\t\tdate_format(curr.renewed_dt, '%Y-%d') as month,\n\t\tcurr.account_renewal_cnt as from_cnt,\n\t\tifnull(next.account_renewal_cnt, 2147483647) as to_cnt\n\tfrom\n\t\t(\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tsrcdt.account_periods) as curr\n\tleft join (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tsrcdt.account_periods) as next on\n\t\tcurr.account_rk = next.account_rk\n\t\tand curr.account_renewal_cnt = next.account_renewal_cnt - 1\n\twhere\n\t\tnext.account_rk is null\n\t)\n) as trans\ngroup by\n\tmonth,\n\tfrom_cnt,\n\tto_cnt\n", "valid_until": 1571789100.0, "rows": 6507, "hash": -1350589319903549538, "data": "('2010-01', 0, 1, 2740)"}