{"sql": "SELECT \n    years.year_no,\n    IFNULL(new_dep.deposit_amnt, 0) AS new_deposits_amnt,\n    IFNULL(new_dep.prolong_amnt, 0) AS prolong_deposits_amnt,\n    IFNULL(rised_deposits.rised_deposits_amnt, 0) AS rised_deposits_amnt\nFROM\n    (SELECT DISTINCT\n        year_no\n    FROM\n        srcdt.calendar) AS years\n        LEFT JOIN\n    (SELECT \n        YEAR(renewed_dt) AS year_no,\n        SUM(IF(account_renewal_cnt = 1, 1, 0)) AS deposit_amnt,\n        SUM(IF(account_renewal_cnt > 1, 1, 0)) AS prolong_amnt\n    FROM\n        srcdt.account_periods\n    GROUP BY year_no) AS new_dep\n    ON years.year_no = new_dep.year_no\n    LEFT JOIN\n    (SELECT \n\t\tYEAR(acc_p2.renewed_dt) AS year_no,\n\t\tCOUNT(*) AS rised_deposits_amnt\n    FROM \n\t\tsrcdt.account_periods AS acc_p1, srcdt.account_periods AS acc_p2\n\tWHERE acc_p1.account_rk =  acc_p2.account_rk \n\t\tAND acc_p1.account_renewal_cnt + 1 = acc_p2.account_renewal_cnt\n        AND 3 * acc_p1.opening_amt < 2 * acc_p2.opening_amt\n    GROUP BY year_no) AS rised_deposits\n    ON new_dep.year_no = rised_deposits.year_no\n", "valid_until": 253402300800.0, "rows": 13, "hash": 6135695584710108749, "data": "(2007, Decimal('0'), Decimal('0'), 0)"}