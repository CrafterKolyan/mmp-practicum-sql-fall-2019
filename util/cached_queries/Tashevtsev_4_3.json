{"sql": "SELECT\n\tDATE_FORMAT(prev_state.expiration_dt, \"%Y-%m\") AS MONTH,\n    prev_state.account_renewal_cnt AS FROM_CNT,\n    IFNULL(next_state.account_renewal_cnt, 2147483647) AS TO_CNT,\n    COUNT(*) AS CNT\nFROM (\n\tSELECT account_rk, account_renewal_cnt, expiration_dt\n\tFROM account_periods\n    WHERE expiration_dt <= CURDATE()\n) AS prev_state LEFT JOIN (\n\tSELECT account_rk, account_renewal_cnt, renewed_dt\n    FROM account_periods\n) AS next_state\nON prev_state.account_rk = next_state.account_rk AND\n\tprev_state.expiration_dt = next_state.renewed_dt\nGROUP BY MONTH, FROM_CNT, TO_CNT\nUNION\nSELECT\n\tDATE_FORMAT(renewed_dt, \"%Y-%m\") AS MONTH,\n\t0 AS FROM_CNT,\n    1 AS TO_CNT,\n    COUNT(*) AS CNT\nFROM account_periods\nWHERE account_renewal_cnt = 1 AND renewed_dt <= CURDATE()\nGROUP BY MONTH\n", "valid_until": 1574467500.0, "rows": 2095, "hash": -3683801839427878777, "data": "('2010-01', 0, 1, 685)"}