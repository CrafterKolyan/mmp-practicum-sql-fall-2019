{"sql": "SELECT\n  years.year_no,\n  IFNULL(deposits, 0) AS deposits_openings,\n  IFNULL(prolongations, 0) AS prolongations,\n  IFNULL(prolongations_with_50_percent_boost, 0) AS prolongations_with_50_percent_boost\nFROM (\n  SELECT DISTINCT\n    year_no\n  FROM\n    calendar\n  ) AS years\n  LEFT JOIN (\n    SELECT\n      YEAR(renewed_dt) AS year_no,\n      COUNT(*) AS deposits\n    FROM\n      account_periods\n    WHERE account_renewal_cnt = 1\n    GROUP BY year_no) AS deposits\n    ON years.year_no = deposits.year_no\n  LEFT JOIN (\n    SELECT\n      YEAR(renewed_dt) AS year_no,\n      COUNT(*) AS prolongations\n    FROM\n      account_periods\n    WHERE account_renewal_cnt > 1\n    GROUP BY year_no) AS prolongations\n    ON years.year_no = prolongations.year_no\n  LEFT JOIN (\n    SELECT\n      YEAR(ac2.renewed_dt) AS year_no,\n      COUNT(*) AS prolongations_with_50_percent_boost\n    FROM\n      account_periods AS ac1\n      JOIN account_periods AS ac2\n        ON ac1.account_rk = ac2.account_rk\n        AND ac1.account_renewal_cnt + 1 = ac2.account_renewal_cnt\n    WHERE ac1.opening_amt * 3 < 2 * ac2.opening_amt\n    GROUP BY year_no) AS prolongations_50\n    ON years.year_no = prolongations_50.year_no\n", "valid_until": 253402300800.0, "rows": 13, "hash": 6135695584710108749, "data": "(2007, 0, 0, 0)"}