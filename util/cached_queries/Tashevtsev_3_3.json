{"sql": "SELECT\n    cal.YEAR,\n    IFNULL(op.COUNT_OPENED, 0),\n    IFNULL(ext.COUNT_EXTENDED, 0),\n    IFNULL(prof.COUNT_PROFITABLE_EXT, 0)\nFROM (\n    SELECT DISTINCT\n    \tyear_no as YEAR\n    FROM calendar\n) as cal\nLEFT JOIN (\n    SELECT\n        YEAR(renewed_dt) as YEAR,\n        COUNT(*) as COUNT_OPENED\n    FROM account_periods\n    WHERE account_renewal_cnt = 1\n    GROUP BY YEAR\n) as op\nON cal.YEAR = op.YEAR\nLEFT JOIN (\n    SELECT\n        YEAR(renewed_dt) as YEAR,\n        COUNT(*) as COUNT_EXTENDED\n    FROM account_periods\n    WHERE account_renewal_cnt > 1\n    GROUP BY YEAR\n) as ext\nON cal.YEAR = ext.YEAR\nLEFT JOIN (\n    SELECT\n        YEAR(b.renewed_dt) as YEAR,\n        COUNT(*) as COUNT_PROFITABLE_EXT\n    FROM\n        account_periods as a\n    INNER JOIN\n        account_periods as b\n    ON\n        a.account_rk = b.account_rk AND\n        a.account_renewal_cnt = b.account_renewal_cnt - 1\n    WHERE\n        a.opening_amt * 3 < b.opening_amt * 2\n    GROUP BY YEAR\n) as prof\nON cal.YEAR = prof.YEAR\n", "valid_until": 253402300800.0, "rows": 13, "hash": 6135695584710108749, "data": "(2007, 0, 0, 0)"}