{"sql": "SELECT \n    MONTH, FROM_CNT, TO_CNT, COUNT(*) AS CNT\nFROM\n    ((SELECT \n        b.account_rk,\n            DATE_FORMAT(b.renewed_dt, '%Y-%m') AS MONTH,\n            IFNULL(a.account_renewal_cnt, 0) AS FROM_CNT,\n            b.account_renewal_cnt AS TO_CNT\n    FROM\n        srcdt.account_periods a\n    RIGHT JOIN srcdt.account_periods b ON a.account_rk = b.account_rk\n        AND a.account_renewal_cnt + 1 = b.account_renewal_cnt) UNION (SELECT \n        a.account_rk,\n            DATE_FORMAT(a.expiration_dt, '%Y-%m') AS MONTH,\n            a.account_renewal_cnt AS FROM_CNT,\n            IFNULL(b.account_renewal_cnt, 2147483647) AS TO_CNT\n    FROM\n        srcdt.account_periods a\n    LEFT JOIN srcdt.account_periods b ON a.account_rk = b.account_rk\n        AND a.account_renewal_cnt + 1 = b.account_renewal_cnt)) new_table\nWHERE\n    MONTH <= CURDATE()\nGROUP BY MONTH , FROM_CNT , TO_CNT", "valid_until": 1571789100.0, "rows": 2151, "hash": -6330511329159999781, "data": "('2010-01', 0, 1, 685)"}