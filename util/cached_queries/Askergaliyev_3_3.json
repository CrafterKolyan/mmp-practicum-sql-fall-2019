{"sql": "SELECT\n    years.year_no,\n    IFNULL(left_table.n_opens, 0) AS n_opens,\n    IFNULL(left_table.n_prolongations, 0) AS n_prolongations,\n    IFNULL(right_table.n_increased_deposits, 0) AS n_increased_deposits\nFROM (\n    SELECT DISTINCT\n        year_no\n    FROM\n        calendar\n    ) AS years\nLEFT JOIN (\n    SELECT\n        YEAR(renewed_dt) AS action_year,\n        SUM(account_renewal_cnt = 1) AS n_opens,\n        SUM(account_renewal_cnt > 1) AS n_prolongations\n    FROM\n        account_periods\n\tGROUP BY\n        action_year\n    ) AS left_table\nON years.year_no = left_table.action_year\nLEFT JOIN (\n    SELECT\n        YEAR(former_table.renewed_dt) AS action_year,\n        COUNT(*) AS n_increased_deposits\n    FROM\n\t\taccount_periods AS former_table\n    INNER JOIN\n\t\taccount_periods AS latter_table\n\tON\n\t\tformer_table.account_rk = latter_table.account_rk\n\t\tAND 2 * former_table.opening_amt > 3 * latter_table.opening_amt\n\t\tAND former_table.account_renewal_cnt = latter_table.account_renewal_cnt + 1\n\tGROUP BY\n\t\taction_year\n    ) AS right_table\nON years.year_no = right_table.action_year\n", "valid_until": 253402300800.0, "rows": 13, "hash": 6135695584710108749, "data": "(2007, Decimal('0'), Decimal('0'), 0)"}