{"sql": "select\n\tyears.year_no,\n\tifnull(left_table.n_opens, 0) as n_opens,\n\tifnull(left_table.n_prolongations, 0) as n_prolongations,\n\tifnull(right_table.increased_deposits, 0) as increased_deposits\nfrom\n    (select distinct\n        calendar.year_no\n    FROM\n        srcdt.calendar as calendar\n    ) AS years\n    left join\n    (select\n        year(account_periods.renewed_dt) as action_year,\n        sum(account_periods.account_renewal_cnt = 1) as n_opens,\n        sum(account_periods.account_renewal_cnt > 1) as n_prolongations\n     from srcdt.account_periods as account_periods\n     group by action_year\n    ) as left_table\n    on years.year_no = left_table.action_year\n    left join (\n        select\n            year(left_inner_table.renewed_dt) as action_year,\n            count(*) as increased_deposits\n        from srcdt.account_periods as left_inner_table\n        inner join srcdt.account_periods as right_inner_table\n        on\n            left_inner_table.account_rk = right_inner_table.account_rk\n            and 2 * left_inner_table.opening_amt > 3 * right_inner_table.opening_amt\n            and left_inner_table.account_renewal_cnt = right_inner_table.account_renewal_cnt + 1\n        group by action_year\n    ) as right_table\n    on years.year_no = right_table.action_year\n", "valid_until": 253402300800.0, "rows": 13, "hash": 6135695584710108749, "data": "(2007, Decimal('0'), Decimal('0'), 0)"}