{"sql": "SELECT DISTINCT\n    customers.customer_rk,\n    customers.last_nm,\n    customers.first_nm,\n    customers.middle_nm\nFROM srcdt.cd_customers AS customers\nINNER JOIN (\n    SELECT t1.customer_rk,\n           t1.account_rk,\n           t1.date_closed,\n           max(t2.expiration_dt) AS all_acc_closed\n    FROM (\n            SELECT\n                customer_rk,\n                account_rk,\n                max(expiration_dt) AS date_closed,\n                min(renewed_dt)    AS date_opened\n            FROM srcdt.account_periods\n            GROUP BY customer_rk, account_rk\n            HAVING year(max(expiration_dt)) = 2011\n        ) AS t1\n    INNER JOIN srcdt.account_periods AS t2\n    ON t1.account_rk != t2.account_rk AND\n       t1.customer_rk = t2.customer_rk AND\n       t2.renewed_dt <= t1.date_closed\n    GROUP BY t1.customer_rk, t1.account_rk, t1.date_closed\n    HAVING all_acc_closed <= t1.date_closed\n) AS closed_all_acc\nON customers.customer_rk = closed_all_acc.customer_rk AND\n   customers.valid_to_dttm = '5999-01-01 00:00:00'\n", "valid_until": 2044870353.484813, "rows": 60, "hash": -8140211665101652740, "data": "(14993, '\u0418\u0411\u0420\u0410\u0413\u0418\u041c\u041e\u0412', '\u0410\u0421\u041b\u0410\u041d', '\u0420\u041e\u041c\u0410\u041d\u041e\u0412\u0418\u0427')"}