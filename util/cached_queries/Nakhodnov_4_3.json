{"sql": "select\n    date_format(left_table.expiration_dt, '%Y-%m') as month,\n    left_table.account_renewal_cnt as from_cnt,\n    ifnull(right_table.account_renewal_cnt, 2147483647) as to_cnt,\n    count(*) as cnt\nfrom\n    (\n        select\n            account_periods.account_rk,\n            account_periods.expiration_dt,\n            account_periods.account_renewal_cnt\n        from srcdt.account_periods as account_periods\n        where account_periods.expiration_dt <= curdate()\n    ) as left_table\n    left join\n    srcdt.account_periods as right_table\n    on\n        left_table.account_rk = right_table.account_rk and\n        left_table.expiration_dt = right_table.renewed_dt\ngroup by month, from_cnt, to_cnt\nunion all\nselect\n    date_format(left_table.renewed_dt, '%Y-%m') as month,\n    0 as from_cnt,\n    left_table.account_renewal_cnt as to_cnt,\n    count(*) as cnt\nfrom\n    srcdt.account_periods as left_table\n    left join\n    srcdt.account_periods as right_table\n    on\n        left_table.account_rk = right_table.account_rk and\n        right_table.expiration_dt = left_table.renewed_dt\n    where\n        right_table.expiration_dt is null and\n        left_table.renewed_dt <= curdate()\n    group by month, from_cnt, to_cnt\n", "valid_until": 1581379500.0, "rows": 2118, "hash": -1682066427393193305, "data": "('2010-01', 0, 1, 685)"}