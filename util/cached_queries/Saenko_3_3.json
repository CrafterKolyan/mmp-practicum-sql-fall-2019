{"sql": "SELECT ytbl.year_no, IFNULL(opened, 0) AS opened, \nIFNULL(prolonged, 0) AS prolonged, IFNULL(big_prolonged, 0) AS big_prolonged\nFROM \n(\nSELECT DISTINCT year_no \nFROM srcdt.calendar\n) AS ytbl\nLEFT JOIN \n( \nSELECT YEAR(renewed_dt) AS accs_year,\nCOUNT(CASE WHEN account_renewal_cnt = 1 THEN 1 END) AS opened,\nCOUNT(CASE WHEN account_renewal_cnt > 1 THEN 1 END) AS prolonged\nFROM srcdt.account_periods\nGROUP BY accs_year\n) AS a\nON ytbl.year_no = a.accs_year\nLEFT JOIN \n(\nSELECT YEAR(new_accs.renewed_dt) AS deposit_year,\nCOUNT(*) AS big_prolonged\nFROM srcdt.account_periods AS new_accs\nJOIN srcdt.account_periods AS old_accs \nON new_accs.account_rk = old_accs.account_rk\nAND new_accs.account_renewal_cnt - old_accs.account_renewal_cnt = 1\nAND new_accs.opening_amt > 1.5 * old_accs.opening_amt \nGROUP BY deposit_year\n) AS big_deposits\nON a.accs_year = big_deposits.deposit_year\n\n", "valid_until": 253402300800.0, "rows": 13, "hash": 6135695584710108749, "data": "(2007, 0, 0, 0)"}