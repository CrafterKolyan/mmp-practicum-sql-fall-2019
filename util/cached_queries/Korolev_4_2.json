{"sql": "SELECT\n  cd_customers.customer_rk,\n  cd_customers.last_nm,\n  cd_customers.first_nm,\n  cd_customers.middle_nm\nFROM (\n  SELECT DISTINCT\n    ANY_VALUE(customer_rk) AS customer_rk\n  FROM account_periods\n  GROUP BY account_rk\n  HAVING YEAR(MAX(expiration_dt)) = 2011\n) AS customer_ids\nJOIN\n  cd_customers\nON cd_customers.customer_rk = customer_ids.customer_rk\nWHERE valid_to_dttm = '5999-01-01 00:00:00'\n      AND cd_customers.customer_rk NOT IN (\n        SELECT\n          customer_rk\n        FROM (\n          SELECT calendar_dt\n          FROM calendar\n          WHERE year_no = 2011\n        ) AS dates\n          JOIN (\n          SELECT \n            MIN(renewed_dt) AS open_dt,\n            MAX(expiration_dt) AS close_dt,\n            ANY_VALUE(customer_rk) AS customer_rk\n          FROM account_periods\n          GROUP BY account_rk) AS accounts\n          ON accounts.open_dt < dates.calendar_dt AND dates.calendar_dt < accounts.close_dt\n        GROUP BY customer_rk\n        HAVING COUNT(DISTINCT calendar_dt) = (\n          SELECT COUNT(DISTINCT calendar_dt)\n          FROM calendar\n          WHERE year_no = 2011\n        )\n      )", "valid_until": 2044787287.015613, "rows": 10868, "hash": -1950092389934835956, "data": "(15, '\u0410\u041a\u041e\u041f\u042f\u041d', '\u0412\u0410\u041b\u0415\u0420\u0418\u0419', '\u041b\u042c\u0412\u041e\u0412\u0418\u0427')"}