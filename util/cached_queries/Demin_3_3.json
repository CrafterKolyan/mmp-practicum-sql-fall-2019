{"sql": "SELECT prol.dt_year,\n       CASE \n\t\tWHEN opened.cnt_opened > 0 THEN opened.cnt_opened\n        ELSE 0\n\tEND AS cnt_opened,\n       prol.cnt_prolonged, prol_more_50.cnt_more_50\nFROM \n(\n\tSELECT count(*) as cnt_prolonged, YEAR(valid_from_dttm) as dt_year\n\tFROM srcdt.account_periods\n\tWHERE account_renewal_cnt != 1\n\tGROUP BY YEAR(valid_from_dttm)\n        \n) AS prol\nLEFT JOIN \n( \n\tSELECT YEAR(valid_from_dttm) as dt_year, count(*) as cnt_opened\n\tFROM srcdt.account_periods\n    WHERE account_renewal_cnt = 1 \n\tGROUP BY YEAR(valid_from_dttm)\n) AS opened\nON prol.dt_year=opened.dt_year \nLEFT JOIN \n(\n\tSELECT dt_year, count(*) as cnt_more_50\n\tFROM \n\t(\t\n\t\tSELECT YEAR(valid_to_dttm) as dt_year, account_rk, account_renewal_cnt as ac_per_prev, opening_amt as prev_amt\n\t\tFROM srcdt.account_periods\n\t) AS a\n\tLEFT JOIN\n\t(\n\t\tSELECT account_rk, account_renewal_cnt as ac_per_next, opening_amt as next_amt\n\t\tFROM srcdt.account_periods\n\t) AS b \n\tON a.account_rk = b.account_rk AND a.ac_per_prev = b.ac_per_next - 1\n\tWHERE 2*(b.next_amt - a.prev_amt) > a.prev_amt\n\tGROUP BY dt_year\n) prol_more_50\nON prol.dt_year = prol_more_50.dt_year\n", "valid_until": 253402300800.0, "rows": 10, "hash": 3193847143122701252, "data": "(2010, 90155, 24601, 10991)"}