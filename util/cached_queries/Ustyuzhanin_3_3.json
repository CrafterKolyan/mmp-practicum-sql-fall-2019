{"sql": "SELECT\n\tbasic.years, IFNULL(basic.opns, 0), IFNULL(basic.prlngs, 0), IFNULL(stonks._50perc, 0)\nFROM\n(\n\tSELECT\n\t\tYEAR(renewed_dt) as years, SUM(account_renewal_cnt = 1) as opns, SUM(account_renewal_cnt > 1) as prlngs\n\tFROM\n\t\tsrcdt.account_periods\n\tGROUP BY\n\t\tyears\n) as basic\nLEFT JOIN\n(\n\tSELECT\n\t\tfst.years as years, COUNT(*) as _50perc\n\tFROM\n    (\n\t\t(\n\t\t\tSELECT\n\t\t\t\taccount_rk as acc, YEAR(renewed_dt) as years, opening_amt, account_renewal_cnt\n\t\t\tFROM\n\t\t\t\tsrcdt.account_periods\n\t\t) as fst\n\t\tCROSS JOIN\n\t\t(\n\t\t\tSELECT\n\t\t\t\taccount_rk as acc, YEAR(renewed_dt) as years, opening_amt, account_renewal_cnt\n\t\t\tFROM\n\t\t\t\tsrcdt.account_periods\n\t\t) as snd\n\t\tON fst.acc = snd.acc AND fst.account_renewal_cnt = snd.account_renewal_cnt + 1  AND fst.opening_amt > 1.5 * snd.opening_amt\n    )\n    GROUP BY\n\t\tyears\n) as stonks\nON basic.years = stonks.years\n", "valid_until": 2044393100.440415, "rows": 10, "hash": 3193847143122701252, "data": "(2010, Decimal('90155'), Decimal('24601'), 10991)"}