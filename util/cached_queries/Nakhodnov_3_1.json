{"sql": "select\n  left_table.customer_rk,\n  CONCAT(left_table.last_nm, ' ', left_table.first_nm, ' ', left_table.middle_nm) AS full_name,\n  right_table.popularity\nfrom (\n    srcdt.cd_customers as left_table\n    left join (\n        select\n            cd_customers_inner.last_nm,\n            cd_customers_inner.first_nm,\n            cd_customers_inner.middle_nm,\n            count(*) as popularity\n        from srcdt.cd_customers as cd_customers_inner\n        where\n            NOW() BETWEEN cd_customers_inner.valid_from_dttm and cd_customers_inner.valid_to_dttm\n        group by\n            cd_customers_inner.last_nm,\n            cd_customers_inner.first_nm,\n            cd_customers_inner.middle_nm\n        ) as right_table\n    on\n        left_table.last_nm = right_table.last_nm\n        and left_table.first_nm = right_table.first_nm\n        and left_table.middle_nm = right_table.middle_nm\n)\nwhere\n    NOW() BETWEEN left_table.valid_from_dttm and left_table.valid_to_dttm\n", "valid_until": 253402300800.0, "rows": 1338447, "hash": -6566650131899523008, "data": "(3, '\u0413\u0420\u0410\u0427\u0415\u0412 \u0410\u041b\u0415\u041a\u0421\u0410\u041d\u0414\u0420 \u0420\u0410\u0418\u0421\u041e\u0412\u0418\u0427', 1)"}