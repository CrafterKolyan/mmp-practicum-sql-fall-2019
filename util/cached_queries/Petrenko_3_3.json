{"sql": "SELECT \n    year_no,\n    SUM(CASE\n        WHEN account_renewal_cnt = 1 THEN 1\n        ELSE 0\n    END) AS deposit_openings,\n    SUM(CASE\n        WHEN account_renewal_cnt > 1 THEN 1\n        ELSE 0\n    END) AS deposit_prolongations,\n    SUM(growth_flag) AS grown_deposits\nFROM\n    (SELECT \n        a.account_renewal_cnt,\n            a.renewed_dt,\n            (CASE\n                WHEN b.account_renewal_cnt IS NULL THEN 0\n                ELSE 1\n            END) AS growth_flag\n    FROM\n        srcdt.account_periods a\n    LEFT JOIN srcdt.account_periods b ON a.account_rk = b.account_rk\n        AND a.account_renewal_cnt - 1 = b.account_renewal_cnt\n        AND a.opening_amt > b.opening_amt * 1.5) accounts\n        INNER JOIN\n    srcdt.calendar dates ON renewed_dt = calendar_dt\nGROUP BY year_no", "valid_until": 2044393073.37671, "rows": 10, "hash": 3193847143122701252, "data": "(2010, Decimal('90155'), Decimal('24601'), Decimal('10991'))"}