{"sql": "SELECT \n    valid_sq.renewal_year, \n    openings, \n    renewals,\n    large_renewals\nFROM (SELECT \n          IFNULL(SUM(account_renewal_cnt = 1), 0) AS openings,\n          IFNULL(SUM(account_renewal_cnt >= 2), 0) AS renewals,\n          YEAR(renewed_dt) AS renewal_year\n      FROM account_periods \n      GROUP BY renewal_year\n) AS cnt_sq\nLEFT JOIN (SELECT \n               IFNULL(COUNT(ft.account_rk), 0) AS large_renewals,\n\t       YEAR(ft.renewed_dt) AS renewal_year\n\t   FROM account_periods AS ft\n\t   INNER JOIN account_periods AS st\n\t   ON ft.account_rk = st.account_rk AND\n              ft.opening_amt * 2 > st.opening_amt * 3 AND\n              st.account_renewal_cnt = ft.account_renewal_cnt - 1\n\t   GROUP BY renewal_year) AS valid_sq\n    ON cnt_sq.renewal_year = valid_sq.renewal_year\n", "valid_until": 253402300800.0, "rows": 10, "hash": 3193847143122701252, "data": "(2010, Decimal('90155'), Decimal('24601'), 10991)"}