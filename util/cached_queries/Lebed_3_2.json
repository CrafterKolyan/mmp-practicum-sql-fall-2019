{"sql": "select\n\tdates.calendar_dt,\n\tsum(ifnull(measure, 0)) as open_deposites_count\nfrom\n\t(\n\tselect\n\t\tcalendar_dt\n\tfrom\n\t\tsrcdt.calendar\n\twhere\n\t\tcalendar_dt between (\n\t\tselect\n\t\t\tmin(valid_from_dttm)\n\t\tfrom\n\t\t\tsrcdt.cd_customers) and curdate()) as dates\nleft join (\n\tselect\n\t\tcount(*) as measure,\n\t\trenewed_dt,\n\t\texpiration_dt\n\tfrom\n\t\tsrcdt.account_periods\n\tgroup by\n\t\trenewed_dt,\n\t\texpiration_dt) as periods on\n\tdates.calendar_dt >= renewed_dt\n\tand dates.calendar_dt < expiration_dt\ngroup by\n\tdates.calendar_dt", "valid_until": 1576627500.0, "rows": 3637, "hash": -6701781582128508661, "data": "(datetime.date(2010, 1, 2), Decimal('2'))"}